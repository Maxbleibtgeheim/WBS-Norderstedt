/*
THIS IS A GENERATED/BUNDLED FILE BY ESBUILD
if you want to view the source, please visit the github repository of this plugin
*/

var u=Object.defineProperty;var v=Object.getOwnPropertyDescriptor;var b=Object.getOwnPropertyNames;var D=Object.prototype.hasOwnProperty;var I=(d,l)=>{for(var e in l)u(d,e,{get:l[e],enumerable:!0})},M=(d,l,e,i)=>{if(l&&typeof l=="object"||typeof l=="function")for(let t of b(l))!D.call(d,t)&&t!==e&&u(d,t,{get:()=>l[t],enumerable:!(i=v(l,t))||i.enumerable});return d};var y=d=>M(u({},"__esModule",{value:!0}),d);var k={};I(k,{default:()=>c});module.exports=y(k);var n=require("obsidian"),f={de:{MergeFolder:"Ordner zusammenf\xFChren",MergedFilesuffix:"zusammengef\xFChrt",OverwriteFileQuestion:"Vorhandene Datei \xFCberschreiben",Settings:"Einstellungen",SettingIncludeNestedFolders:"Verschachtelte Ordner einbeziehen",SettingIncludeNestedFoldersDescription:"Wenn aktiviert, werden Dateien in verschachtelten Ordnern zusammengef\xFChrt. Andernfalls werden nur Dateien im ausgew\xE4hlten Ordner zusammengef\xFChrt (Standardverhalten).",SettingIncludeFoldersAsSections:"Ordner als Abschnitte einbeziehen",SettingIncludeFoldersAsSectionsDescription:"Ordner werden als benannte Abschnitte in die Ausgabedatei eingef\xFCgt.",Yes:"Ja",No:"Nein",SettingSortMode:"Sortiermodus",SettingSortModeDescription:"W\xE4hlen Sie den Sortiermodus f\xFCr das Zusammenf\xFChren von Notizen.",SettingSortDateCreated:"Erstellungsdatum",SettingSortLogical:"Logisch",SettingSortAlphabetically:"Alphabetisch"},en:{MergeFolder:"Merge folder",MergedFilesuffix:"merged",OverwriteFileQuestion:"Overwite exising file",Settings:"Settings",SettingIncludeNestedFolders:"Include nested folders",SettingIncludeNestedFoldersDescription:"If enabled, files in nested folders will be included in merge. Otherwise, only files in selected folder will be merged (default behaviour).",SettingIncludeFoldersAsSections:"Include folders as sections",SettingIncludeFoldersAsSectionsDescription:"Folders will be included as named sections into output file.",Yes:"Yes",No:"No",SettingSortMode:"Sort mode",SettingSortModeDescription:"Pick the sorting mode for merging notes.",SettingSortDateCreated:"Date created",SettingSortLogical:"Logical",SettingSortAlphabetically:"Alphabetical"},fi:{MergeFolder:"Yhdist\xE4 kansio",MergedFilesuffix:"yhdistetty",OverwriteFileQuestion:"Korvaa olemassa oleva tiedosto",Settings:"Asetukset",SettingIncludeNestedFolders:"Sis\xE4llyt\xE4 sis\xE4kk\xE4iset kansiot",SettingIncludeNestedFoldersDescription:"Jos k\xE4yt\xF6ss\xE4, sis\xE4kk\xE4isten kansioiden tiedostot yhdistet\xE4\xE4n. Muussa tapauksessa vain valitun kansion tiedostot yhdistet\xE4\xE4n (oletustoiminto).",SettingIncludeFoldersAsSections:"Sis\xE4llyt\xE4 kansiot osioihin",SettingIncludeFoldersAsSectionsDescription:"Kansiot sis\xE4llytet\xE4\xE4n nimettyin\xE4 osina tulostiedostoon.",Yes:"Kyll\xE4",No:"Ei",SettingSortMode:"Lajittelu j\xE4rjestys",SettingSortModeDescription:"Valitse lajittelutapa muistiinpanojen yhdist\xE4mist\xE4 varten.",SettingSortDateCreated:"Luontip\xE4iv\xE4m\xE4\xE4r\xE4",SettingSortLogical:"Looginen",SettingSortAlphabetically:"Aakkosj\xE4rjestys"},fr:{MergeFolder:"Fusionner le dossier",MergedFilesuffix:"fusionn\xE9",OverwriteFileQuestion:"Remplacer le fichier existant",Settings:"Param\xE8tres",SettingIncludeNestedFolders:"Inclure les dossiers imbriqu\xE9s",SettingIncludeNestedFoldersDescription:"Si activ\xE9, les fichiers des dossiers imbriqu\xE9s seront inclus dans la fusion. Sinon, seuls les fichiers du dossier s\xE9lectionn\xE9 seront fusionn\xE9s (comportement par d\xE9faut).",SettingIncludeFoldersAsSections:"Inclure les dossiers en tant que sections",SettingIncludeFoldersAsSectionsDescription:"Les dossiers seront inclus en tant que sections nomm\xE9es dans le fichier de sortie.",Yes:"Oui",No:"Non",SettingSortMode:"mode de tri",SettingSortModeDescription:"Choisissez le mode de tri pour la fusion des notes.",SettingSortDateCreated:"Date de cr\xE9ation",SettingSortLogical:"Logique",SettingSortAlphabetically:"Alphab\xE9tique"},ru:{MergeFolder:"\u041E\u0431\u044A\u0435\u0434\u0438\u043D\u0438\u0442\u044C \u043F\u0430\u043F\u043A\u0443",MergedFilesuffix:"\u0441\u043E\u0432\u043C\u0435\u0449\u0435\u043D\u043D\u044B\u0439",OverwriteFileQuestion:"\u041F\u0435\u0440\u0435\u0437\u0430\u043F\u0438\u0441\u0430\u0442\u044C \u0441\u0443\u0449\u0435\u0441\u0442\u0432\u0443\u044E\u0449\u0438\u0439 \u0444\u0430\u0439\u043B",Settings:"\u041D\u0430\u0441\u0442\u0440\u043E\u0439\u043A\u0438",SettingIncludeNestedFolders:"\u0412\u043B\u044E\u0447\u0430\u0442\u044C \u0432\u043B\u043E\u0436\u0435\u043D\u043D\u044B\u0435 \u043F\u0430\u043F\u043A\u0438",SettingIncludeNestedFoldersDescription:"\u0415\u0441\u043B\u0438 \u0432\u043A\u043B\u044E\u0447\u0435\u043D\u043E, \u0444\u0430\u0439\u043B\u044B \u0432\u043E \u0432\u043B\u043E\u0436\u0435\u043D\u043D\u044B\u0445 \u043F\u0430\u043F\u043A\u0430\u0445 \u0431\u0443\u0434\u0443\u0442 \u0432\u043A\u043B\u044E\u0447\u0435\u043D\u044B \u0432 \u0441\u043B\u0438\u044F\u043D\u0438\u0435. \u0412 \u043F\u0440\u043E\u0442\u0438\u0432\u043D\u043E\u043C \u0441\u043B\u0443\u0447\u0430\u0435 \u0431\u0443\u0434\u0443\u0442 \u043E\u0431\u044A\u0435\u0434\u0438\u043D\u0435\u043D\u044B \u0442\u043E\u043B\u044C\u043A\u043E \u0444\u0430\u0439\u043B\u044B \u0432 \u0432\u044B\u0431\u0440\u0430\u043D\u043D\u043E\u0439 \u043F\u0430\u043F\u043A\u0435 (\u043F\u043E\u0432\u0435\u0434\u0435\u043D\u0438\u0435 \u043F\u043E \u0443\u043C\u043E\u043B\u0447\u0430\u043D\u0438\u044E).",SettingIncludeFoldersAsSections:"\u0412\u043A\u043B\u044E\u0447\u0430\u0442\u044C \u043F\u0430\u043F\u043A\u0438 \u043A\u0430\u043A \u0440\u0430\u0437\u0434\u0435\u043B\u044B",SettingIncludeFoldersAsSectionsDescription:"\u041F\u0430\u043F\u043A\u0438 \u0431\u0443\u0434\u0443\u0442 \u0432\u043A\u043B\u044E\u0447\u0435\u043D\u044B \u0432 \u0432\u044B\u0445\u043E\u0434\u043D\u043E\u0439 \u0444\u0430\u0439\u043B \u0432 \u043A\u0430\u0447\u0435\u0441\u0442\u0432\u0435 \u0440\u0430\u0437\u0434\u0435\u043B\u043E\u0432.",Yes:"\u0414\u0430",No:"\u041D\u0435\u0442",SettingSortMode:"\u0440\u0435\u0436\u0438\u043C \u0441\u043E\u0440\u0442\u0438\u0440\u043E\u0432\u043A\u0438",SettingSortModeDescription:"\u0412\u044B\u0431\u0435\u0440\u0438\u0442\u0435 \u0440\u0435\u0436\u0438\u043C \u0441\u043E\u0440\u0442\u0438\u0440\u043E\u0432\u043A\u0438 \u043F\u0440\u0438 \u043E\u0431\u044A\u0435\u0434\u0438\u043D\u0435\u043D\u0438\u0438 \u0437\u0430\u043C\u0435\u0442\u043E\u043A.",SettingSortDateCreated:"\u0414\u0430\u0442\u0430 \u0441\u043E\u0437\u0434\u0430\u043D\u0438\u044F",SettingSortLogical:"\u041B\u043E\u0433\u0438\u0447\u0435\u0441\u043A\u0438\u0439",SettingSortAlphabetically:"\u0410\u043B\u0444\u0430\u0432\u0438\u0442\u043D\u044B\u0439 \u0443\u043A\u0430\u0437\u0430\u0442\u0435\u043B\u044C"},ua:{MergeFolder:"\u041E\u0431'\u0454\u0434\u043D\u0430\u0442\u0438 \u043F\u0430\u043F\u043A\u0443",MergedFilesuffix:"\u043E\u0431'\u0454\u0434\u043D\u0430\u043D\u0456",OverwriteFileQuestion:"\u041F\u0435\u0440\u0435\u0437\u0430\u043F\u0438\u0441\u0430\u0442\u0438 \u0456\u0441\u043D\u0443\u044E\u0447\u0438\u0439 \u0444\u0430\u0439\u043B",Settings:"\u041D\u0430\u043B\u0430\u0448\u0442\u0443\u0432\u0430\u043D\u043D\u044F",SettingIncludeNestedFolders:"\u0412\u043A\u043B\u044E\u0447\u0438\u0442\u0438 \u0432\u043A\u043B\u0430\u0434\u0435\u043D\u0456 \u043F\u0430\u043F\u043A\u0438",SettingIncludeNestedFoldersDescription:"\u042F\u043A\u0449\u043E \u0432\u0432\u0456\u043C\u043A\u043D\u0435\u043D\u043E, \u0444\u0430\u0439\u043B\u0438 \u0443 \u0432\u043A\u043B\u0430\u0434\u0435\u043D\u0438\u0445 \u043F\u0430\u043F\u043A\u0430\u0445 \u0431\u0443\u0434\u0443\u0442\u044C \u0432\u043A\u043B\u044E\u0447\u0435\u043D\u0456 \u0432 \u043E\u0431\u2019\u0454\u0434\u043D\u0430\u043D\u043D\u044F. \u0412 \u0456\u043D\u0448\u043E\u043C\u0443 \u0432\u0438\u043F\u0430\u0434\u043A\u0443 \u0431\u0443\u0434\u0435 \u043E\u0431\u2019\u0454\u0434\u043D\u0430\u043D\u043E \u043B\u0438\u0448\u0435 \u0444\u0430\u0439\u043B\u0438 \u0443 \u0432\u0438\u0431\u0440\u0430\u043D\u0456\u0439 \u043F\u0430\u043F\u0446\u0456 (\u043F\u043E\u0432\u0435\u0434\u0456\u043D\u043A\u0430 \u0437\u0430 \u0437\u0430\u043C\u043E\u0432\u0447\u0443\u0432\u0430\u043D\u043D\u044F\u043C).",SettingIncludeFoldersAsSections:"\u0412\u043A\u043B\u044E\u0447\u0438\u0442\u0438 \u043F\u0430\u043F\u043A\u0438 \u044F\u043A \u0440\u043E\u0437\u0434\u0456\u043B\u0438",SettingIncludeFoldersAsSectionsDescription:"\u041F\u0430\u043F\u043A\u0438 \u0431\u0443\u0434\u0443\u0442\u044C \u0432\u043A\u043B\u044E\u0447\u0435\u043D\u0456 \u044F\u043A \u0456\u043C\u0435\u043D\u043E\u0432\u0430\u043D\u0456 \u0440\u043E\u0437\u0434\u0456\u043B\u0438 \u0443 \u0432\u0438\u0445\u0456\u0434\u043D\u0438\u0439 \u0444\u0430\u0439\u043B.",Yes:"\u0422\u0430\u043A",No:"\u041D\u0456",SettingSortMode:"\u041B\u043E\u0433\u0438\u0447\u0435\u0441\u043A\u0438\u0439",SettingSortModeDescription:"\u0412\u0438\u0431\u0435\u0440\u0456\u0442\u044C \u0440\u0435\u0436\u0438\u043C \u0441\u043E\u0440\u0442\u0443\u0432\u0430\u043D\u043D\u044F \u0434\u043B\u044F \u043E\u0431'\u0454\u0434\u043D\u0430\u043D\u043D\u044F \u043D\u043E\u0442\u0430\u0442\u043E\u043A.",SettingSortDateCreated:"\u0414\u0430\u0442\u0430 \u0441\u0442\u0432\u043E\u0440\u0435\u043D\u043D\u044F",SettingSortLogical:"\u041B\u043E\u0433\u0456\u0447\u043D\u0438\u0439",SettingSortAlphabetically:"\u0417\u0430 \u0430\u043B\u0444\u0430\u0432\u0456\u0442\u043E\u043C"}},w={sortMode:"logical",includeNestedFolders:!1,includeFoldersAsSections:!1},E="git-merge",T="Advanced Merger",C="en",L="file-menu",x=`
`,S=`

`,A="#",$="md",c=class extends n.Plugin{async onload(){this.translation=new F,await this.loadSettings(),this.registerEvent(this.app.workspace.on(L,(e,i)=>{if(!(i instanceof n.TFolder))return;let t=i;e.addItem(r=>{r.setTitle(this.translation.get().MergeFolder).setIcon(E).onClick(async a=>await this.onClickCallback(t,a))})})),this.addSettingTab(new h(this.app,this))}async onClickCallback(e,i){let{vault:t}=this.app,r=[];n.Vault.recurseChildren(e,s=>{s instanceof n.TFile&&s.extension==$?(console.log(`Found a file: ${s.name}`),r.push(s)):s instanceof n.TFolder&&this.settings.includeFoldersAsSections&&(console.log(`Found a folder: ${s.name}`),r.push(s))});let a=this.sortNotes(r.filter(s=>this.filterNotes(e,s))),o=`${e.path}-${this.translation.get().MergedFilesuffix}.md`;if(await t.adapter.exists(o,!1)){new p(this.app,this.translation,o,async s=>{if(!s){console.info(`file "${o}" already exists, but user cancelled deleting..`);return}console.info(`file "${o}" already exists, deleting..`),await t.adapter.remove(o),await this.mergeNotes(t,a,o)}).open();return}await this.mergeNotes(t,a,o)}async mergeNotes(e,i,t){let r=await e.create(t,"");for(let a=0;a<i.length;a++){let o=i[a],g=(o.path.match(/\//g)||[]).length,s=`${a===0?"":x}`,N=a===i.length-1;if(o instanceof n.TFile){s+=await e.cachedRead(o);let m=o.name.replace(/\.md$/,"");s=`${A.repeat(g)} ${m}${S}${s}${N?"":S}`,console.info(`Adding file "${o.name}" as section "${m}" into file "${t}"..`)}else o instanceof n.TFolder&&(s+=`${A.repeat(g)} ${o.name}${S}`,console.info(`Adding folder "${o.name}" as section "${s}" into file "${t}"..`));e.append(r,s)}}filterNotes(e,i){var t,r;return this.settings.includeNestedFolders?!!((t=i.parent)!=null&&t.path.startsWith(e.path)):((r=i.parent)==null?void 0:r.path)==e.path}sortNotes(e){switch(this.settings.sortMode){case"alphabetical":return e.sort((i,t)=>i.name.localeCompare(t.name));case"creationDate":return e.sort((i,t)=>i.stat.ctime-t.stat.ctime);case"logical":default:return e.sort((i,t)=>i.path.localeCompare(t.path,void 0,{numeric:!0,sensitivity:"base",usage:"sort"}))}}async loadSettings(){let e=await this.loadData();console.log("Loaded settings",e),this.settings=Object.assign({},w,await this.loadData())}async saveSettings(){console.log("Saving settings",this.settings),await this.saveData(this.settings)}},h=class extends n.PluginSettingTab{constructor(e,i){super(e,i);this.plugin=i}display(){let{containerEl:e}=this;e.empty(),e.createEl("h2",{text:`${T} - ${this.plugin.translation.get().Settings}`}),new n.Setting(e).setName(this.plugin.translation.get().SettingSortMode).setDesc(this.plugin.translation.get().SettingSortModeDescription).addDropdown(i=>i.addOptions({alphabetical:this.plugin.translation.get().SettingSortAlphabetically,creationDate:this.plugin.translation.get().SettingSortDateCreated,logical:this.plugin.translation.get().SettingSortLogical}).onChange(async t=>{this.plugin.settings.sortMode=t,await this.plugin.saveSettings()}).setValue(this.plugin.settings.sortMode)),new n.Setting(e).setName(this.plugin.translation.get().SettingIncludeNestedFolders).setDesc(this.plugin.translation.get().SettingIncludeNestedFoldersDescription).addToggle(i=>i.setValue(this.plugin.settings.includeNestedFolders).onChange(async t=>{this.plugin.settings.includeNestedFolders=t,this.plugin.settings.includeFoldersAsSections=t===!1?t:this.plugin.settings.includeFoldersAsSections,await this.plugin.saveSettings(),this.showIncludeFolderAsSectionSetting(e)})),this.showIncludeFolderAsSectionSetting(e)}showIncludeFolderAsSectionSetting(e){var i,t;if(!this.plugin.settings.includeNestedFolders){(t=(i=this.includeFolderAsSectionSetting)==null?void 0:i.settingEl)==null||t.remove();return}this.includeFolderAsSectionSetting=new n.Setting(e).setName(this.plugin.translation.get().SettingIncludeFoldersAsSections).setDesc(this.plugin.translation.get().SettingIncludeFoldersAsSectionsDescription).addToggle(r=>r.setValue(this.plugin.settings.includeFoldersAsSections).onChange(async a=>{this.plugin.settings.includeFoldersAsSections=a,await this.plugin.saveSettings()}))}},p=class extends n.Modal{constructor(e,i,t,r){super(e);this.tranlation=i,this.existingFileName=t,this.onSubmitHandler=r}onOpen(){let{contentEl:e}=this;e.createEl("h3",{text:`${this.tranlation.get().OverwriteFileQuestion} "${this.existingFileName}"?`}),new n.Setting(e).addButton(i=>i.setButtonText(this.tranlation.get().No).setCta().onClick(()=>{this.close(),this.onSubmitHandler(!1)})).addButton(i=>i.setButtonText(this.tranlation.get().Yes).setCta().onClick(()=>{this.close(),this.onSubmitHandler(!0)}))}onClose(){let{contentEl:e}=this;e.empty()}},F=class{constructor(){this.language=Object.keys(f).contains(navigator.language)?navigator.language:C}get(){return f[this.language]}};
